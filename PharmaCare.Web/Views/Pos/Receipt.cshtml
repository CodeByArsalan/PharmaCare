@model PharmaCare.Web.Models.POS.ReceiptViewModel
@{
    ViewData["Title"] = "Receipt";
    Layout = null; // No layout for print-friendly receipt
}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Receipt - @Model.SaleNumber</title>
    <link rel="stylesheet" href="~/assets/css/core.css" />
    <link rel="stylesheet" href="~/css/custom-theme.css" />
    <style>
        @@media print {
            .no-print {
                display: none !important;
            }

            body {
                background: white;
            }
        }

        .receipt-container {
            max-width: 400px;
            margin: 50px auto;
            padding: 30px;
            background: white;
            border: 1px solid #ddd;
        }

        .receipt-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #333;
            padding-bottom: 15px;
        }

        .receipt-table {
            width: 100%;
            margin: 20px 0;
        }

        .receipt-table td {
            padding: 8px 0;
        }

        .receipt-total {
            border-top: 2px solid #333;
            margin-top: 15px;
            padding-top: 15px;
            font-size: 1.2em;
            font-weight: bold;
        }

        .receipt-footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 15px;
            border-top: 1px dashed #999;
            font-size: 0.9em;
            color: #666;
        }
    </style>
</head>

<body>
    <div class="receipt-container">
        <!-- Header -->
        <div class="receipt-header">
            <h2 style="margin: 0; color: #0EA5E9;">PharmaCare</h2>
            <p style="margin: 5px 0 0 0; color: #666;">Your Health, Our Priority</p>
        </div>

        <!-- Sale Info -->
        <div style="margin-bottom: 20px;">
            <table style="width: 100%; font-size: 0.9em;">
                <tr>
                    <td><strong>Receipt #:</strong></td>
                    <td style="text-align: right;">@Model.SaleNumber</td>
                </tr>
                <tr>
                    <td><strong>Date:</strong></td>
                    <td style="text-align: right;">@Model.SaleDate.ToString("dd/MM/yyyy hh:mm tt")</td>
                </tr>
                @if (!string.IsNullOrEmpty(Model.CustomerName))
                {
                        <tr>
                            <td><strong>Customer:</strong></td>
                            <td style="text-align: right;">@Model.CustomerName</td>
                        </tr>
                }
                @if (!string.IsNullOrEmpty(Model.CustomerPhone))
                {
                        <tr>
                            <td><strong>Phone:</strong></td>
                            <td style="text-align: right;">@Model.CustomerPhone</td>
                        </tr>
                }
            </table>
        </div>

        <!-- Items -->
        <table class="receipt-table">
            <thead style="border-bottom: 1px solid #ddd;">
                <tr>
                    <th style="text-align: left;">Item</th>
                    <th style="text-align: center;">Qty</th>
                    <th style="text-align: right;">Price</th>
                    <th style="text-align: right;">Total</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.Items)
                {
                        <tr>
                            <td style="padding: 8px 0;">
                                <div>@item.ProductName</div>
                                <small style="color: #666;">Batch: @item.BatchNumber</small>
                            @if (item.DiscountAmount > 0)
                            {
                                        <div><small style="color: #e74c3c;">Discount: Rs. @item.DiscountAmount.ToString("N2")</small>
                                        </div>
                            }
                            </td>
                            <td style="text-align: center;">@item.Quantity</td>
                            <td style="text-align: right;">@item.UnitPrice.ToString("N2")</td>
                            <td style="text-align: right;">@item.Subtotal.ToString("N2")</td>
                        </tr>
                }
            </tbody>
        </table>

        <div class="receipt-total">
            <table style="width: 100%;">
                <tr style="font-size: 0.9em; font-weight: normal;">
                    <td>Gross Total:</td>
                    <td style="text-align: right;">Rs. @Model.SubTotal.ToString("N2")</td>
                </tr>
                @if (Model.DiscountAmount > 0)
                {
                        <tr style="font-size: 0.9em; font-weight: normal; color: #e74c3c;">
                            <td>Discount Amount (@Model.DiscountPercent.ToString("N1")%):</td>
                            <td style="text-align: right;">- Rs. @Model.DiscountAmount.ToString("N2")</td>
                        </tr>
                }
                <tr style="border-top: 1px solid #ddd; padding-top: 5px;">
                    <td><strong>Net Total:</strong></td>
                    <td style="text-align: right;"><strong>Rs. @Model.Total.ToString("N2")</strong></td>
                </tr>
                @foreach (var payment in Model.Payments)
                {
                        <tr style="font-size: 0.9em; font-weight: normal;">
                            <td>Paid (@payment.PaymentMethod):</td>
                            <td style="text-align: right;">Rs. @payment.Amount.ToString("N2")</td>
                        </tr>
                }
                @if (Model.Change > 0)
                {
                        <tr style="font-size: 0.9em; font-weight: normal;">
                            <td>Change:</td>
                            <td style="text-align: right;">Rs. @Model.Change.ToString("N2")</td>
                        </tr>
                }
            </table>
        </div>

        <!-- Footer -->
        <div class="receipt-footer">
            <p style="margin: 10px 0;">Thank you for your business!</p>
            <p style="margin: 5px 0;">Please keep this receipt for your records</p>
        </div>

        <!-- Print Button -->
        <div class="text-center mt-4 no-print">
            <button onclick="window.print()" class="btn btn-primary btn-lg me-2">
                <i class="bx bx-printer me-1"></i> Print Receipt
            </button>
            <a href="/Pos/Index" class="btn btn-label-secondary btn-lg">
                <i class="bx bx-arrow-back me-1"></i> Back to POS
            </a>
        </div>
    </div>

    <script src="~/lib/jquery/dist/jquery.js"></script>
    <script src="~/assets/js/bootstrap.js"></script>
</body>

</html>
